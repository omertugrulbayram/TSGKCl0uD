<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Bulut Kaşifleri Frontend</title>
  <style>
    pre {
      background: #222;
      color: #0f0;
      padding: 10px;
      max-height: 300px;
      overflow: auto;
      white-space: pre-wrap;
      word-break: break-word;
    }
  </style>
</head>
<body>
  <h1>Bulut Kaşifleri Frontend</h1>
  <p>Verileri buradan alabilirsiniz</p>
  <button id="getDataBtn">Verileri Getir</button>
  <pre id="result"></pre>

  <script>
    const API_KEY = "cERENhocamadamdır";
    const WORKER_URL = "https://tsgk.omertugrulbayram.workers.dev/";

    document.getElementById('getDataBtn').addEventListener('click', () => {
      fetch(`${WORKER_URL}?key=${API_KEY}`)
        .then(response => {
          if (!response.ok) throw new Error("Erişim reddedildi veya hata oluştu");
          return response.json();
        })
        .then(data => {
          document.getElementById('result').textContent = JSON.stringify(data, null, 2);

          // Google Forms’a log gönderiyoruz frontend’den
          fetch('https://docs.google.com/forms/d/e/1FAIpQLScYNVCrFssQQ_0AbfXcIIy9t_l4RNJMLgsKtDg3ruDwFhX8QA/formResponse', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: new URLSearchParams({
              'entry.1648753359': 'frontend_user',                     // Kullanıcı adı/etiket
              'entry.2065692405': new Date().toISOString(),            // Zaman
              'entry.1602347687': 'API çağrısı frontend’den loglandı'  // Açıklama
            })
          }).catch(e => {
            console.warn('Google Form log gönderilemedi:', e);
          });
        })
        .catch(error => {
          document.getElementById('result').textContent = error.message;
        });
    });
  </script>
</body>
</html>
